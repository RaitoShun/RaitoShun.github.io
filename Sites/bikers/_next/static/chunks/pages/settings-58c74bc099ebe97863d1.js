_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{"/QEs":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n("nKUr"),a=n("q1tI"),o=n("KYPV"),s=n("20a2"),c=n("UGp+"),i=c.a().shape({username:c.c().required("Required"),password:c.c().required("Required")}),u=n("xQut"),l=n("6FwJ"),d=n("aqBw");function m(e){var t=Object(s.useRouter)(),n=Object(a.useState)(""),c=n[0],m=n[1];return Object(r.jsx)(o.c,{initialValues:{username:"",password:""},validationSchema:i,onSubmit:function(n,r){var a=n.username,o=n.password;m("");var s=new Headers;s.append("Content-Type","text/json"),s.set("Authorization","Basic "+d.encode(a+":"+o)),fetch("https://bikers-test.herokuapp.com/login",{method:"get",headers:s}).then((function(e){return e.json()}),(function(e){return"TypeError: Failed to fetch"===e.toString()&&m("Connection failed"),e})).then((function(n){n.token&&(e.runLogin({username:a,token:n.token,public_id:n.public_id}),t.push("/settings"))})).catch((function(e){"Connection failed"!==c&&m("Incorrect username or password")}))},children:function(e){var t=e.errors,n=e.touched,a=e.handleSubmit;return Object(r.jsx)("div",{className:"md:w-4/5 lg:w-1/2 md:h-auto w-full h-screen pt-20 pb-20 bg-login bg-cover bg-center bg-no-repeat mx-auto",children:Object(r.jsx)("div",{className:"md:flex md:justify-center",children:Object(r.jsxs)(o.b,{className:"md:p-6",children:[Object(r.jsx)(l.a,{w:"full",h:"auto",color:"white",className:"mx-auto md:w-96"}),Object(r.jsxs)("div",{className:"flex flex-col items-center py-5 md:py-0 md:my-20 md:h-auto h-full",children:[Object(r.jsx)("label",{htmlFor:"username",className:"text-white",children:"Username"}),t.username&&n.username?Object(r.jsx)("p",{className:"text-red",children:t.username}):null,Object(r.jsx)(o.a,{className:"login-field w-full".concat(t.username&&n.username?"border-2 border-red":""),name:"username"}),Object(r.jsx)("label",{htmlFor:"password",className:"text-white mt-5",children:"Password"}),t.password&&n.password?Object(r.jsx)("p",{className:"text-red",children:t.password}):null,Object(r.jsx)(o.a,{className:"login-field ".concat(t.password&&n.password?"border-2 border-red":""),name:"password",type:"password"}),Object(r.jsx)("p",{className:"text-red",children:c}),Object(r.jsx)("div",{className:"my-5 md:w-auto w-4/5",children:Object(r.jsx)(u.a,{onClick:function(){return a()},isShort:!0,text:"Login"})})]})]})})})}})}var h=n("H352"),f=n("VMhO"),p=n.n(f),b=c.a().shape({currentUsername:c.c().min(2,"Too Short!").max(14,"Too Long!").required("Required"),newUserName:c.c().min(2,"Too Short!").max(14,"Too Long!").required("Required"),newCurrentPass:c.c().required("Required"),confirmCurrentPass:c.c().oneOf([c.b("confirmCurrentPass"),null],"Passwords must match").required("Required"),newUserPass:c.c().required("Required"),confirmNewUserPass:c.c().oneOf([c.b("newUserPass"),null],"Passwords must match").required("Required")}),j=n("ynW6"),w=n("9rZX"),x=n.n(w);n("aqBw");function g(e){var t=e.user,n=e.runLogin,s=e.runLogout,c=Object(a.useState)(!1),i=c[0],l=c[1],d=Object(a.useState)(""),m=d[0],h=d[1];return Object(r.jsx)(o.c,{initialValues:{currentUsername:t.username,newUserName:"",newCurrentPass:"",confirmCurrentPass:"",newUserPass:"",confirmNewUserPass:""},validationSchema:b,onSubmit:function(e,t){},children:function(e){var a=e.errors,c=e.touched,d=(e.handleSubmit,e.values);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(x.a,{isOpen:i,className:"bg-modal \r text-white w-96 h-24 text-center text-2xl bg-cover bg-center bg-no-repeat pt-8 \r absolute left-1/2 transform -translate-x-1/2 top-1/2 -translate-y-1/2",ariaHideApp:!0,style:{overlay:{position:"fixed",width:"100vw",height:"100vh",zIndex:30}},children:m}),Object(r.jsx)("div",{className:"xl:mt-0 bg-menublue md:w-4/5 w-full md:mx-auto py-20",children:Object(r.jsxs)("div",{className:"flex lg:flex-row flex-col justify-around text-white w-full relative",children:[Object(r.jsxs)(o.b,{className:"lg:mx-0 mx-auto md:pb-0 pb-20",children:[Object(r.jsxs)("h1",{className:"text-3xl mb-10",children:["My ",Object(r.jsx)("br",{}),"Account"]}),Object(r.jsxs)("div",{className:"flex flex-col w-full border-white",children:[Object(r.jsx)(j.a,{fieldType:"register-field",label:"Change Username",name:"currentUsername",touched:c,errors:a,color:"white"}),Object(r.jsx)(j.a,{fieldType:"register-field",label:"New Password",name:"newCurrentPass",type:"password",touched:c,errors:a,color:"white"}),Object(r.jsx)(j.a,{fieldType:"register-field",label:"Confirm New Password",name:"confirmCurrentPass",type:"password",touched:c,errors:a,color:"white"}),Object(r.jsxs)("div",{className:"my-5",children:[Object(r.jsx)(u.a,{onClick:function(){n({token:t.token,public_id:t.public_id,username:d.currentUsername}),function(e){var n=e.username,r=e.password,a=new Headers;a.append("Content-Type","application/json"),a.append("x-access-token",t.token),h("Changing..."),l(!0),fetch("https://bikers-test.herokuapp.com/user/"+t.public_id,{method:"PUT",headers:a,body:JSON.stringify({username:n,password:r})}).then((function(e){return e.json()})).then((function(e){h("Account Credentials changed."),setTimeout((function(){l(!1)}),1200)})).catch((function(e){h("Request Failed"),setTimeout((function(){l(!1)}),1200)}))}({username:d.currentUsername,password:d.confirmCurrentPass})},text:"Change Account Credentials"}),Object(r.jsx)(u.a,{onClick:function(){s()},text:"Sign Out"}),Object(r.jsx)(u.a,{onClick:function(){!function(){var e=new Headers;e.append("Content-Type","application/json"),e.append("x-access-token",t.token),h("Deleting..."),l(!0),fetch("https://bikers-test.herokuapp.com/user/"+t.public_id,{method:"DELETE",headers:e}).then((function(e){return e.json()})).then((function(e){"The last admin cannot be deleted"===e.message?(h(e.message),setTimeout((function(){l(!1)}),1200)):(h("Deleted. Logging out..."),setTimeout((function(){s()}),1200))})).catch((function(e){h("Request Failed"),setTimeout((function(){l(!1)}),1200)}))}()},text:"Delete My Account"})]})]})]}),Object(r.jsx)("div",{className:"\r lg:absolute bg-white lg:w-1 lg:h-4/5 lg:my-0 lg:mx-0 w-2/3 h-1 top-1/2 transform\r -translate-y-1/2 rounded mx-auto box-border"}),Object(r.jsxs)(o.b,{className:"lg:mx-0 mx-auto pt-20 md:pt-0 ",children:[Object(r.jsxs)("h1",{className:"text-3xl mb-10",children:["Create a New",Object(r.jsx)("br",{})," Administrator"]}),Object(r.jsxs)("div",{className:"flex flex-col",children:[Object(r.jsx)(j.a,{fieldType:"register-field",label:"Username",name:"newUserName",color:"white"}),Object(r.jsx)(j.a,{fieldType:"register-field",label:"Password",name:"newUserPass",color:"white"}),Object(r.jsx)(j.a,{fieldType:"register-field",label:"Confirm Password",name:"ConfirmNewUserPass",color:"white"}),Object(r.jsxs)("div",{className:"my-5",children:[Object(r.jsx)(u.a,{onClick:function(){!function(e){var n=e.username,r=e.password,a=new Headers;a.append("Content-Type","application/json"),a.append("x-access-token",t.token),h("Creating..."),l(!0),fetch("https://bikers-test.herokuapp.com/user",{method:"POST",headers:a,body:JSON.stringify({username:n,password:r})}).then((function(e){return e.json()})).then((function(e){h("Account Created."),setTimeout((function(){l(!1)}),1200)})).catch((function(e){h("Request Failed"),setTimeout((function(){l(!1)}),1200)}))}({username:d.newUserName,password:d.confirmNewUserPass})},text:"Create New Admin"}),Object(r.jsx)(u.a,{onClick:function(){l(!0),h("Starting Download..."),fetch("https://bikers-test.herokuapp.com/job",{method:"get",headers:{params:JSON.stringify({filter:"all"}),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=e.jobs;p()(t,"export.csv"),l(!1)})).catch((function(e){h("Request Failed"),setTimeout((function(){l(!1)}),1200)}))},text:"Download New CSV"})]})]})]})]})})]})}})}var O=n("dRT2");function v(){return Object(r.jsx)(h.a,{children:Object(r.jsx)(O.a,{DefaultComponent:Object(r.jsx)(m,{}),AuthComponent:Object(r.jsx)(g,{})})})}},VMhO:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var n=e,a=t||"export.csv",o=Array.from(new Set(n.reduce((function(e,t){return[].concat(r(e),r(Object.keys(t)))}),[]))),s=n.map((function(e){return o.map((function(t){return JSON.stringify(e[t]||"")})).join(",")}));s.unshift(o.join(",")),s=s.join("\r\n");var c=new Blob([s],{type:"text/plain;charset=utf-8"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,a);else{var i=document.createElement("a"),u=URL.createObjectURL(c);i.href=u,i.download=a,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}},aqBw:function(e,t,n){(function(e,r){var a;!function(o){var s=t,c=(e&&e.exports,"object"==typeof r&&r);c.global!==c&&c.window;var i=function(e){this.message=e};(i.prototype=new Error).name="InvalidCharacterError";var u=function(e){throw new i(e)},l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=/[\t\n\f\r ]/g,m={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&u("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,r,a,o=e.length%3,s="",c=-1,i=e.length-o;++c<i;)t=e.charCodeAt(c)<<16,n=e.charCodeAt(++c)<<8,r=e.charCodeAt(++c),s+=l.charAt((a=t+n+r)>>18&63)+l.charAt(a>>12&63)+l.charAt(a>>6&63)+l.charAt(63&a);return 2==o?(t=e.charCodeAt(c)<<8,n=e.charCodeAt(++c),s+=l.charAt((a=t+n)>>10)+l.charAt(a>>4&63)+l.charAt(a<<2&63)+"="):1==o&&(a=e.charCodeAt(c),s+=l.charAt(a>>2)+l.charAt(a<<4&63)+"=="),s},decode:function(e){var t=(e=String(e).replace(d,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&u("Invalid character: the string to be decoded is not correctly encoded.");for(var n,r,a=0,o="",s=-1;++s<t;)r=l.indexOf(e.charAt(s)),n=a%4?64*n+r:r,a++%4&&(o+=String.fromCharCode(255&n>>(-2*a&6)));return o},version:"1.0.0"};void 0===(a=function(){return m}.call(t,n,t,e))||(e.exports=a)}()}).call(this,n("LY0y")(e),n("ntbh"))},dRT2:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("q1tI"),a=n.n(r);function o(e){var t=e.AuthComponent,n=e.DefaultComponent,o=Object(r.useState)({token:"",username:"",public_id:""}),s=o[0],c=o[1];function i(e){var t=e.token,n=e.username,r=e.public_id;localStorage.setItem("username",n),localStorage.setItem("token",t),localStorage.setItem("public_id",r),c({token:t,username:n,public_id:r})}function u(){localStorage.removeItem("username"),localStorage.removeItem("token"),localStorage.removeItem("public_id"),c({token:"",username:"",public_id:""})}return Object(r.useEffect)((function(){c({username:localStorage.getItem("username")?localStorage.getItem("username"):"",token:localStorage.getItem("token")?localStorage.getItem("token"):"",public_id:localStorage.getItem("public_id")?localStorage.getItem("public_id"):""})}),[]),s.token.length?a.a.cloneElement(t,{runLogin:i,runLogout:u,user:s}):a.a.cloneElement(n,{runLogin:i,runLogout:u,user:s})}},rrX4:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return n("/QEs")}])}},[["rrX4",0,2,4,1,3,5]]]);